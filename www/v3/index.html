<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Kharbga</title>
    <meta name="viewport" content="initial-scale=1, user-scalable=no, width=device-width">
    <link rel="stylesheet" href="../css/kharbga.css" />
    <!-- <link rel="stylesheet" href="../lib/bootstrap/css/bootstrap.min.css"> -->
    <!-- <link rel="stylesheet" href="../lib/jquery.mobile/jquery.mobile-1.4.5.min.css"> -->

    <link rel="stylesheet" href="../css/themes/Kharbga2.min.css">
    <link rel="stylesheet" href="../css/themes/jquery.mobile.icons.min.css">
    <link rel="stylesheet" href="../lib/jquery.mobile/jquery.mobile.structure-1.4.5.css">
    <link rel="shortcut icon" href="../img/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="../css/site.css">
    <link rel="stylesheet" href="./index.css">

    <!--  <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script> -->
    <script src="../lib/jquery/jquery-1.11.3.min.js"></script>
    <script src="../lib/jquery.mobile/jquery.mobile-1.4.5.min.js"></script>
</head>

<body>
    <section data-role="page" id="first" data-theme="a">
        <header data-role="header" data-position="fixed">
            <h4><img src="../img/kharbga.png" style="max-height:25px"></h4>
            <a href="#menu-panel" data-icon="user" data-iconpos="notext" class="ui-btn-right">Info</a>
            <a href="#play-watch-section" data-icon="bars" class="ui-btn-left ui-shadow ui-corner-all ui-btn-inline ui-mini" data-iconpos="notext">Play/Watch</a>
        </header>
        <article role="main" class="ui-content">
            <div id="menu-panel" data-role="panel" data-position="right" data-display="overlay" data-theme="a">
                <a href="#" data-rel="close" class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
                <img src="../img/kharbga.png" style="max-height:40px" title="Kharbga Game Network" />
                <div class="panel panel-info">
                    <div class="panel-heading ui-bar ui-bar-b">My Account</div>
                    <div class="panel-body ui-body">
                        <p id="login-li">
                            <a id="login-link-v3" href="#login-popup" data-rel="popup" data-position-to="window">
                                <span class="glyphicon glyphicon-log-in"></span> Login</a>
                        </p>
                        <p id="logout-li">
                            <span id="account-welcome" class="text-success"></span>
                            <br><a id="logout-link" href="#logout"><span class="glyphicon glyphicon-log-out"></span>Sign Out</a>
                        </p>
                        <p>If this is your first time here, please click <a href="../html/rules.html">here
                                to learn about the game.</a></p>
                        <p>
                            This system provides a platform for learning and playing this fun board game from North Africa.
                        </p>
                        <figure class="center">
                            <a href="#popup-menu" data-rel="popup">
                                <img src="../img/players.png" style="width:90%;" class="img" title="Kharbga game played in the desert of North Africa">
                            </a>
                            <figcaption>
                                <strong>Kharbga Game Played on a Sand Board in North Africa</strong>
                            </figcaption>
                        </figure>
                        <p>
                            Click here to <a href="#popup-menu" data-rel="popup">start a new game as Attacker or Defender</a> playing with other players or with the System.</a>
                        </p>
                    </div>
                    <div class="ui-bar ui-bar-c">Choose from the options below to learn more about this system.</div>
                    <ul data-role="listview" data-inset="true">
                        <li><a target="rules" href="../html/rules.html">Game Rules</a></li>
                        <li><a target="rules" href="../html/terms.html">Terms & Conditions</a></li>
                        <li><a target="rules" href="../html/privacy.html">Privacy</a></li>
                        <li><a target="nouris" href="http://www.nourisolutions.com/company/message/send/1">Contact Us</a></li>
                    </ul>
                </div>
                <div class="ui-body">
                    <p>
                        If you are a developer interested in contributing, please <a href="http://www.nourisolutions.com/company/message/send/1">contact us</a> for additional info and let us know how you could help.
                    </p>
                    <strong>Thank you!</strong>
                    <a href="#play-watch-section" class="ui-btn ui-shadow ui-corner-all ui-btn-inline">Join / Watch Active Games</a>

                    <p class="center">
                        <hr>
                        <a href="#" class="center" data-rel="close">Close</a></p>
                    <hr>
                    </p>
                </div>
            </div>
            <div id="play-watch-section" data-role="panel" data-position="left" data-display="overlay" data-theme="a">
                <a href="#" data-rel="close" class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
                <img src="../img/kharbga.png" style="max-height:40px" title="Kharbga Game Network" />
                <div class="panel panel-info">
                    <div class="ui-bar ui-bar-b">
                        </a> Active Games
                    </div>
                </div>
                <div class="text-center center ui-body ui-body-b">
                    <a id="games-link" href="#" class="glyphicon glyphicon-refresh ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-refresh ui-btn-icon-notext ui-btn-left">Refresh
                    <a href="#popup-menu" data-rel="popup" data-transition="slideup" data-icon="gear">Create a New Game</a>
                    <ul id="games-list" data-role="listview" data-inset="true" style="height: 80%;max-height:600px;overflow-y:scroll" class="list-group ">
                    </ul>
                </div>
                <div class="center ui-bar ui-bar-c">
                    <a href="#" data-rel="close">Close</a>
                </div>

            </div>
            <div class="row ui-grid-b kharbga-grid">
                <div class="col-sm-4 col-md-5 col-lg-4 panel panel-success ui-block-a">
                    <div class="panel-heading ui-bar ui-bar-a">
                        Kharbga Board - <strong>Turn:</strong> <span id="player-turn" class="badge"></span> <strong> 
                    </div>
                    <div class="">
                        <div class="panel-body ">
                        
                            <!-- The Board -->
                            <div id="board" style="max-width:300px"></div>
                        </div>   
                  
                    </div>                  
                    <div class="panel-footer ui-bar ui-bar-c">
                        <a id="flipOrientation" href="#" class="pull-right ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-recycle ui-btn-icon-notext ui-btn-right" 
                        data-icon="recycle"     
                            value="Flip orientation">Flip</a>
                        
                            Board State:</strong> <span id="state" class="badge"></span>
                        <br>
                        <hr>
                    </div>
                    <div class="ui-grid ui-grid-a">
                        <div class="ui-block-a">
                            <input id="resign-checkbox" type="checkbox" name="resign-checkbox" data-mini="true" class="">
                            <label for="resign-checkbox">Resign</label>
                        </div>
                        <div class="ui-block-b">
                            <a id="clear-board-button" data-mini="true" href="#" class="ui-btn ui-shadow ui-corner-all ui-mini ui-btn-inline ">Clear</a>
                        </div>
                    </div>
                    <p>To resign, check the above checkbox and make any move on the board on your turn.</p>
                </div>
                <div class="col-sm-4 ui-block-b" xstyle="padding-top:70px;">
                    <div class="panel-heading ui-bar ui-bar-a">
                        Current Game Information
                    </div>


                    <div class="message" id="message" class=""></div>
                    <audio id="sound" preload="auto">
                        
                    <source src="../img/button-26.mp3" type="audio/mpeg">
                    </audio>
                    <div class="panel panel-success">
                        <div class="panel-heading ui-bar ui-bar-b">
                            <small>Game ID: <span id="current-game-id"></span></small>
                        </div>
                        <div class="panel-body">
                            <p>
                                <label class="text-info" for="current-game-status">Game State: 
                                    <span id="current-game-status" class="badge"></span>
                                </label>
                            </p>
                            <p>
                                <label class="text-info" for="gameMove">Last Action: 
                                    <span id="gameMove" class="badge"></span>
                                </label>
                            </p>
                            <p class="text-success">FEN: <span id="fen" class=""></span></p>

                            <hr>
                            <div id="game-moves-history">
                                <div class="ui-bar ui-bar-c">
                                    <strong>Moves History</strong>
                                </div>
                                <div class="ui-body">
                                    <ul data-role='listview' id='game-moves-history-list' style='height:250px;max-height:350px; overflow-y:scroll'>
                                    </ul>
                                </div>

                            </div>
                        </div>
                    </div>
                    <hr/>
                    <p class="text-center center">
                        <a href="#popup-menu" data-mini="true" data-rel="popup" data-transition="slideup" data-icon="gear" class="ui-btn ui-mini ui-icon-gear ui-shadow ui-corner-all ui-btn-inline ">New Game</a>
                        <a href="#play-watch-section" data-mini="true" class="ui-mini ui-btn ui-shadow ui-corner-all ui-btn-inline">Join / Watch Active Games</a>

                    </p>
                    <div id="popup-menu" data-role="popup">
                        <ul data-role="listview" data-inset="true">
                            <li><a id="new-game-attacker" href="#play-attacker">As Attacker</a></li>
                            <li><a id="new-game-defender" href="#play-defender">As Defender</a></li>
                            <li><a id="new-game-attacker-system" href="#play-attacker-system">As Attacker against
                                            system</a></li>
                            <li><a id="new-game-defender-system" href="#play-defender-system">As Defender against
                                            system</a></li>
                        </ul>

                    </div>

                </div>
                <div class="col-sm-4 col-md-6 col-lg-6 ui-block-c">
                    <div class="panel-heading ui-bar ui-bar-b">
                        <h3>Network Messages</h3>
                    </div>
                    <div class="panel-body ui-body">
                        <label for="move-message">Message:</label>
                        <input type="text" xclass="form-control" id="move-message" name="move-message">
                        <button id="postMessageBtn" type="submit" class="ui-mini btn btn-default ui-btn ui-btn-inline">Post</button>
                        <a href="#" data-icon="refresh" id="server-link" value="connect-server" class="ui-mini btn btn-default ui-btn ui-btn-inline">
                                Reconnect
                            </a>
                        <a href="#" id="ping-link" value="ping" class="ui-mini btn btn-default ui-btn ui-btn-inline">Ping Server</a>
                        <div class="ui-bar ui-bar-c">
                            <small>Net Messages - URI: <span id="server-uri"></span> -</small>

                        </div>
                        <div class="ui-body">

                            <ul id="messages-list" class="list-group" data-role="listview" style="height: 400px;overflow-y:scroll"></ul>
                        </div>
                    </div>
                </div>
            </div>
            <div id="login-popup" data-role="popup" data-theme="a" class="ui-content" style="max-width:400px;">
                <a href="#" data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
                <div class="panel panel-info">
                    <div data-role="header" class="panel-heading ui-bar" data-theme="b">
                        Login
                    </div>

                    <div class="panel-body ui-body">
                        <div class="">
                            <span id="account-message" class="text-success"></span>
                            <form class="form-horizontal" id="login-form" novalidate>
                                <div class="form-group">
                                    <label class="control-label col-sm-4" for="login-id">Login ID:</label>
                                    <div class="col-sm-6 input-group">

                                        <input type="text" class="form-control" id="login-id" placeholder="Enter login id" required size="30" minlength="6" maxlength="30">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="control-label col-sm-4" for="login-pwd">Password:</label>
                                    <div class="col-sm-6 input-group">

                                        <input type="password" class="form-control" id="login-pwd" placeholder="Enter password" required size="30" minlength="6" maxlength="30">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <div class="col-sm-offset-4 col-sm-6">
                                        <button id="login-submit" type="submit" class="btn btn-default ui-btn ui-btn-inline ">Submit</button>

                                    </div>
                                </div>
                            </form>
                        </div>

                        <div class="alert alert-warning ui-bar ui-bar-c">
                            To play with other users in the network, you need to have a valid user account. </strong>
                            Click here to <a href="../html/register.html" target="account">sign up if not already registered.</a>.
                        </div>
                        <hr>
                    </div>
                </div>
            </div>
            <a href="#dev-support-panel" xclass="ui-btn-left ui-shadow ui-corner-all ui-btn-inline ui-mini">Development & Operation Support</a>

            <div id="dev-support-panel" xdata-role="panel" xdata-theme="b" xdata-position="right">
                <div data-role="tabs" id="game-tabs">
                    <div data-role="navbar">
                        <ul>
                            <li>
                                <a href="#tab-server" data-ajax="false">Server Status</a>
                            </li>
                            <li>
                                <a href="#tab-game-state" data-ajax="false">Game State</a>
                            </li>
                            <li>
                                <a href="#tab-app-state" data-ajax="false">Client App State</a>
                            </li>
                            <li>
                                <a href="#tab-user-state" data-ajax="false">User State</a>
                            </li>
                        </ul>
                    </div>

                    <div id="tab-server">

                        <h4>API URL: <span id="api-url"></span>
                            <a href="#" id="refreshAppInfo-submit" data-icon="refresh" value="Refresh" class="">
                             Refresh
                    </a></h4>
                        <div id="help-message"> </div>
                        <table id="app-info-table" class="table table-striped">
                            <tbody id="app-info-table-body">

                            </tbody>
                        </table>
                    </div>
                    <div id="tab-game-state">
                        <h4>Active Game State
                            <a href="#" id="game-state-link" value="Refresh">
                             Refresh
                        </a>
                        </h4>

                        <div class="panel-body">
                            <div id="game-state-message"> </div>
                            <table id="game-state-table" class="table table-striped">
                                <tbody id="game-state-table-body">

                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div id="tab-app-state">
                        <h4>App Client State -
                            <a href="#" id="app-state-link" value="Refresh">
                            Refresh
                        </a>
                        </h4>
                        <div class="panel-body">
                            <div id="app-state-message"> </div>
                            <table id="app-state-table" class="table table-striped">
                                <tbody id="app-state-table-body">

                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div id="tab-user-state">
                        <h4>User and Account State -
                            <a href="#" id="user-state-link" value="Refresh">
                            Refresh
                        </a>
                        </h4>
                        <div class="panel-body">
                            <div id="user-state-message"> </div>
                            <table id="user-state-table" class="table table-striped">
                                <tbody id="user-state-table-body">

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- </div><a href="#second" data-role="button" data-inline="true" data-transition="flow" data-icon="carat-r" data-iconpos="right">Go to Page 2</a>
           -->
        </article>
        <footer data-role="footer" data-position="fixed">
            <h4>Developed & Operated By <a target="nouris" href="http://www.nouriSolutions.com">Nouri&nbsp;Solutions,&nbsp;LLC</a></h4>
        </footer>
    </section>
    <script src="../lib/json/json3.min.js"></script>
    <!--  <script src="../lib/jquery/jquery.min.js"></script> -->


    <script src="../jsconfig/env.js"></script>
    <script src="../js/jquery.signalR-2.3.0.js"></script>
    <script src="../js/jquery.validate.js"></script>
    <script src="../js/additional-methods.js"></script>
    <script>
        var scriptToLoad = window.__env.baseURI + "signalR/hubs";
        console.log("loading: " + scriptToLoad);
        var signalRElement = document.createElement('script');
        signalRElement.setAttribute('src', scriptToLoad);
        document.body.appendChild(signalRElement)
        console.log("loading: " + scriptToLoad);
    </script>

    <script src="../js/moment.min.js"></script>
    <script src="../js/kharbga-ui.js"></script>
    <script src="../js/kharbga.js"></script>
    <script src="../js/ns-api-client.js"></script>
    <script src="../js/ns-app.kharbga.js"></script>
    <script src="index.js"></script>
    <script type="text/javascript">
        //<![CDATA[
        $(document).ready(function() {
            //  $('.combobox').combobox()
            var kApp = new KharbgaApp();
            var setupOk = kApp.initMessaging();
            if (setupOk == false) {
                // alert("Unable to setup connection to the server. Please try again later!");
                // try again after a couple of sec
                setTimeout(function() {
                    kApp.initMessaging();
                }, 2000);
            }

            kApp.initBoard({
                themePath: '../img/theme-simple/{piece}.png'
            });
        });
        //]]>
    </script>
</body>

</html>